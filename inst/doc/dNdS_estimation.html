<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2016-03-04" />

<title>dNdS estimation using orthologr</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>


<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div class="fluid-row" id="header">


<h1 class="title">dNdS estimation using orthologr</h1>
<h4 class="date"><em>2016-03-04</em></h4>

</div>


<p>The dN/dS ratio quantifies the mode and strength of selection acting on a pair of orthologous genes. This selection pressure can be quantified by comparing synonymous substitution rates (dS) that are assumed to be neutral with nonsynonymous substitution rates (dN), which are exposed to selection as they change the amino acid composition of a protein (<a href="http://mbe.oxfordjournals.org/content/31/1/212">Mugal et al., 2013</a>).</p>
<p>The <code>orthologr</code> package provides a function named <code>dNdS()</code> to perform dNdS estimation on pairs of orthologous genes. The <code>dNdS()</code> function takes the CDS files of two organisms of interest (<code>query_file</code> and <code>subject_file</code>) and computes the dNdS estimation values for orthologous gene pairs between these organisms.</p>
<p><strong>Note:</strong> the following dNdS estimation methods are based on KaKs_Calculator:</p>
<ul>
<li><p>“NG”: Nei, M. and Gojobori, T. (1986)</p></li>
<li><p>“LWL”: Li, W.H., et al. (1985)</p></li>
<li><p>“LPB”: Li, W.H. (1993) and Pamilo, P. and Bianchi, N.O. (1993)</p></li>
<li><p>“MLWL” (Modified LWL), MLPB (Modified LPB): Tzeng, Y.H., et al. (2004)</p></li>
<li><p>“YN”: Yang, Z. and Nielsen, R. (2000)</p></li>
<li><p>“MYN” (Modified YN): Zhang, Z., et al. (2006)</p></li>
</ul>
<p>It is assumed that when you choose one of these dNdS estimation methods you have <a href="https://code.google.com/p/kaks-calculator/wiki/KaKs_Calculator">KaKs_Calculator</a> installed on your machine and it can be executed from the default execution <code>PATH</code>.</p>
<p>The following pipeline resembles an example dNdS estimation procedure:</p>
<ol style="list-style-type: decimal">
<li><p>Orthology Inference: e.g. BLAST reciprocal best hit (RBH)</p></li>
<li><p>Pairwise sequence alignment: e.g. clustalw for pairwise amino acid sequence alignments</p></li>
<li><p>Codon Alignment: e.g. pal2nal program</p></li>
<li><p>dNdS estimation: e.g. <a href="http://mbe.oxfordjournals.org/content/17/1/32.short">Yang, Z. and Nielsen, R. (2000)</a> (YN)</p></li>
</ol>
<p><strong>Note:</strong> it is assumed that when using <code>dNdS()</code> all corresponding multiple sequence alignment programs you want to use are already installed on your machine and are executable via either the default execution PATH or you specifically define the location of the executable program via the <code>aa_aln_path</code> or <code>blast_path</code> argument that can be passed to <code>dNdS()</code>. See the <a href="https://github.com/HajkD/orthologr/blob/master/vignettes/sequence_alignments.Rmd">Sequence Alignments vignette</a> for details.</p>
<p>The following example shall illustrate a dNdS estimation process.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(orthologr)

<span class="co"># get a dNdS table using:</span>
<span class="co"># 1) reciprocal best hit for orthology inference (RBH)</span>
<span class="co"># 2) clustalw for pairwise amino acid alignments</span>
<span class="co"># 3) pal2nal for codon alignments</span>
<span class="co"># 4) Yang, Z. and Nielsen, R. (2000) (YN) for dNdS estimation</span>
<span class="co"># 5) single core processing 'comp_cores = 1'</span>
<span class="kw">dNdS</span>( <span class="dt">query_file      =</span> <span class="kw">system.file</span>(<span class="st">'seqs/ortho_thal_cds.fasta'</span>, <span class="dt">package =</span> <span class="st">'orthologr'</span>),
      <span class="dt">subject_file    =</span> <span class="kw">system.file</span>(<span class="st">'seqs/ortho_lyra_cds.fasta'</span>, <span class="dt">package =</span> <span class="st">'orthologr'</span>),
      <span class="dt">ortho_detection =</span> <span class="st">&quot;RBH&quot;</span>, 
      <span class="dt">aa_aln_type     =</span> <span class="st">&quot;multiple&quot;</span>,
      <span class="dt">aa_aln_tool     =</span> <span class="st">&quot;clustalw&quot;</span>, 
      <span class="dt">codon_aln_tool  =</span> <span class="st">&quot;pal2nal&quot;</span>, 
      <span class="dt">dnds_est.method =</span> <span class="st">&quot;YN&quot;</span>, 
      <span class="dt">comp_cores      =</span> <span class="dv">1</span>, 
      <span class="dt">clean_folders   =</span> <span class="ot">TRUE</span>, 
      <span class="dt">quiet           =</span> <span class="ot">TRUE</span> )</code></pre></div>
<pre><code>       query_id            subject_id         dN        dS      dNdS method
 1: AT1G01010.1 333554|PACid_16033839 0.10581700 0.2844350 0.3720250     YN
 2: AT1G01020.1 470181|PACid_16064328 0.04164150 0.0951677 0.4375590     YN
 3: AT1G01030.1 470180|PACid_16054974 0.01664670 0.1163900 0.1430260     YN
 4: AT1G01040.1 333551|PACid_16057793 0.01421700 0.1314360 0.1081670     YN
 5: AT1G01050.1 909874|PACid_16064489         NA 0.2092450 0.0000000     YN
 6: AT1G01060.3 470177|PACid_16043374 0.04387800 0.1131710 0.3877130     YN
 7: AT1G01070.1 918864|PACid_16052578 0.02028020 0.0960773 0.2110820     YN
 8: AT1G01080.1 909871|PACid_16053217 0.03930610 0.0995795 0.3947210     YN
 9: AT1G01090.1 470171|PACid_16052860 0.00992436 0.2496940 0.0397461     YN
10: AT1G01110.2 333544|PACid_16034284 0.03292970 0.1293160 0.2546450     YN
11: AT1G01120.1 918858|PACid_16049140 0.00356132 0.1225410 0.0290623     YN
12: AT1G01140.3 470161|PACid_16036015 0.00582238 0.1354990 0.0429699     YN
13: AT1G01150.1 918855|PACid_16037307 0.13565500 0.1962460 0.6912480     YN
14: AT1G01160.1 918854|PACid_16044153 0.11558300 0.1929560 0.5990120     YN
15: AT1G01170.2 311317|PACid_16052302 0.00557175 0.2903370 0.0191906     YN
16: AT1G01180.1 909860|PACid_16056125 0.04065370 0.1557400 0.2610360     YN
17: AT1G01190.1 311315|PACid_16059488 0.02849220 0.1538610 0.1851810     YN
18: AT1G01200.1 470156|PACid_16041002 0.01983450 0.1512510 0.1311360     YN
19: AT1G01210.1 311313|PACid_16057125 0.02106910 0.1433630 0.1469630     YN
20: AT1G01220.1 470155|PACid_16047984 0.01530070 0.1446480 0.1057780     YN
</code></pre>
<p>The output includes <code>NA</code> values. To filter for <code>NA</code> values or a specific <code>dnds.threshold</code>, you can use the <code>filter_dNdS()</code> function. The <code>filter_dNdS()</code> function takes the output data.table returned by <code>dNdS()</code> and filters the output by the following criteria:</p>
<ol style="list-style-type: decimal">
<li><p>all dN values having an NA value are omitted</p></li>
<li><p>all dS values having an NA value are omitted</p></li>
<li><p>all dNdS values &gt;= the specified <code>dnds.threshold</code> are omitted</p></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(orthologr)

<span class="co"># get dNdS estimated for orthologous genes between A. thaliana and A. lyrata</span>

Ath_Aly_dnds &lt;-<span class="st"> </span><span class="kw">dNdS</span>( <span class="dt">query_file      =</span> <span class="kw">system.file</span>(<span class="st">'seqs/ortho_thal_cds.fasta'</span>, <span class="dt">package =</span> <span class="st">'orthologr'</span>),
                      <span class="dt">subject_file    =</span> <span class="kw">system.file</span>(<span class="st">'seqs/ortho_lyra_cds.fasta'</span>, <span class="dt">package =</span> <span class="st">'orthologr'</span>),
                      <span class="dt">dnds_est.method =</span> <span class="st">&quot;YN&quot;</span>, 
                      <span class="dt">comp_cores      =</span> <span class="dv">1</span>, 
                      <span class="dt">clean_folders   =</span> <span class="ot">TRUE</span>, 
                      <span class="dt">quiet           =</span> <span class="ot">TRUE</span> )

        
<span class="co"># filter for:</span>
<span class="co"># 1) all dN values having an NA value are omitted</span>
<span class="co"># 2) all dS values having an NA value are omitted</span>
<span class="co"># 3) all dNdS values &gt;= 2 are omitted</span>

<span class="kw">filter_dNdS</span>(Ath_Aly_dnds, <span class="dt">dnds.threshold =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>
      query_id            subject_id         dN        dS      dNdS method
1  AT1G01010.1 333554|PACid_16033839 0.10581700 0.2844350 0.3720250     YN
2  AT1G01020.1 470181|PACid_16064328 0.04164150 0.0951677 0.4375590     YN
3  AT1G01030.1 470180|PACid_16054974 0.01664670 0.1163900 0.1430260     YN
4  AT1G01040.1 333551|PACid_16057793 0.01421700 0.1314360 0.1081670     YN
5  AT1G01060.3 470177|PACid_16043374 0.04387800 0.1131710 0.3877130     YN
6  AT1G01070.1 918864|PACid_16052578 0.02028020 0.0960773 0.2110820     YN
7  AT1G01080.1 909871|PACid_16053217 0.03930610 0.0995795 0.3947210     YN
8  AT1G01090.1 470171|PACid_16052860 0.00992436 0.2496940 0.0397461     YN
9  AT1G01110.2 333544|PACid_16034284 0.03292970 0.1293160 0.2546450     YN
10 AT1G01120.1 918858|PACid_16049140 0.00356132 0.1225410 0.0290623     YN
11 AT1G01140.3 470161|PACid_16036015 0.00582238 0.1354990 0.0429699     YN
12 AT1G01150.1 918855|PACid_16037307 0.13565500 0.1962460 0.6912480     YN
13 AT1G01160.1 918854|PACid_16044153 0.11558300 0.1929560 0.5990120     YN
14 AT1G01170.2 311317|PACid_16052302 0.00557175 0.2903370 0.0191906     YN
15 AT1G01180.1 909860|PACid_16056125 0.04065370 0.1557400 0.2610360     YN
16 AT1G01190.1 311315|PACid_16059488 0.02849220 0.1538610 0.1851810     YN
17 AT1G01200.1 470156|PACid_16041002 0.01983450 0.1512510 0.1311360     YN
18 AT1G01210.1 311313|PACid_16057125 0.02106910 0.1433630 0.1469630     YN
19 AT1G01220.1 470155|PACid_16047984 0.01530070 0.1446480 0.1057780     YN
</code></pre>
<p>Instead of using a multiple alignment tool for pairwise alignments you can also choose a global pairwise alignment of orthologous genes based on the Needleman-Wunsch algorithm. For this purpose the argument <code>aa_aln_type</code> must be set to <code>aa_aln_type = &quot;pairwise&quot;</code> and <code>aa_aln_tool = &quot;NW&quot;</code> for Needleman-Wunsch.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(orthologr)

<span class="co"># get a dNdS table using:</span>
<span class="co"># 1) reciprocal best hit for orthology inference (RBH)</span>
<span class="co"># 2) pairwise amino acid alignments using Needleman-Wunsch</span>
<span class="co"># 3) pal2nal for codon alignments</span>
<span class="co"># 4) Comeron (1995) for dNdS estimation</span>
<span class="co"># 5) single core processing 'comp_cores = 1'</span>
<span class="kw">dNdS</span>( <span class="dt">query_file      =</span> <span class="kw">system.file</span>(<span class="st">'seqs/ortho_thal_cds.fasta'</span>, <span class="dt">package =</span> <span class="st">'orthologr'</span>),
      <span class="dt">subject_file    =</span> <span class="kw">system.file</span>(<span class="st">'seqs/ortho_lyra_cds.fasta'</span>, <span class="dt">package =</span> <span class="st">'orthologr'</span>),
      <span class="dt">ortho_detection =</span> <span class="st">&quot;RBH&quot;</span>, 
      <span class="dt">aa_aln_type     =</span> <span class="st">&quot;pairwise&quot;</span>,
      <span class="dt">aa_aln_tool     =</span> <span class="st">&quot;NW&quot;</span>, 
      <span class="dt">codon_aln_tool  =</span> <span class="st">&quot;pal2nal&quot;</span>, 
      <span class="dt">dnds_est.method =</span> <span class="st">&quot;Comeron&quot;</span>, 
      <span class="dt">comp_cores      =</span> <span class="dv">1</span>, 
      <span class="dt">clean_folders   =</span> <span class="ot">TRUE</span>, 
      <span class="dt">quiet           =</span> <span class="ot">TRUE</span> )</code></pre></div>
<pre><code>
       query_id            subject_id       dN     dS    dNdS
 1: AT1G01010.1 333554|PACid:16033839 0.106400 0.2537 0.41950
 2: AT1G01020.1 470181|PACid:16064328 0.040230 0.1037 0.38790
 3: AT1G01030.1 470180|PACid:16054974 0.014990 0.1265 0.11850
 4: AT1G01040.1 333551|PACid:16057793 0.013470 0.1165 0.11560
 5: AT1G01050.1 909874|PACid:16064489 0.000000 0.1750 0.00000
 6: AT1G01060.3 470177|PACid:16043374 0.044950 0.1133 0.39670
 7: AT1G01070.1 918864|PACid:16052578 0.018300 0.1059 0.17280
 8: AT1G01080.1 909871|PACid:16053217 0.033980 0.1056 0.32170
 9: AT1G01090.1 470171|PACid:16052860 0.009104 0.2181 0.04174
10: AT1G01110.2 333544|PACid:16034284 0.032480 0.1220 0.26620
11: AT1G01120.1 918858|PACid:16049140 0.003072 0.1326 0.02317
12: AT1G01140.3 470161|PACid:16036015 0.005672 0.1312 0.04324
13: AT1G01150.1 918855|PACid:16037307 0.130000 0.2028 0.64120
14: AT1G01160.1 918854|PACid:16044153 0.104600 0.2804 0.37310
15: AT1G01170.2 311317|PACid:16052302 0.000000 0.3064 0.00000
16: AT1G01180.1 909860|PACid:16056125 0.029680 0.1763 0.16830
17: AT1G01190.1 311315|PACid:16059488 0.028690 0.1618 0.17730
18: AT1G01200.1 470156|PACid:16041002 0.019050 0.1675 0.11370
19: AT1G01210.1 311313|PACid:16057125 0.020670 0.1540 0.13420
20: AT1G01220.1 470155|PACid:16047984 0.015690 0.1533 0.10230
</code></pre>
<p>The <code>dNdS()</code> function can be used choosing the following options:</p>
<ul>
<li><code>ortho_detection</code> : <code>RBH</code> (BLAST best reciprocal hit), <code>BH</code> (BLAST best reciprocal hit), <code>PO</code> (ProteinOrtho), and <code>OrthoMCL</code> (OrthoMCL)</li>
<li><code>aa_aln_type</code> : <code>multiple</code> or <code>pairwise</code></li>
<li><code>aa_aln_tool</code> : <code>clustalw</code>, <code>t_coffee</code>, <code>muscle</code>, <code>clustalo</code>, <code>mafft</code>, and <code>NW</code> (in case <code>aa_aln_type = &quot;pairwise&quot;</code>)</li>
<li><code>codon_aln_tool</code> : <code>pal2nal</code></li>
<li><code>dnds_est.method</code> : <code>Li</code>, <code>Comeron</code>, <code>NG</code>, <code>LWL</code>, <code>LPB</code>, <code>MLWL</code>, <code>YN</code>, and <code>MYN</code></li>
</ul>
<p>Please see <code>?dNdS</code> for details.</p>
<p>In case your BLAST program, or multiple alignment program can not be executed from the default execution <code>PATH</code> you can specify the <code>aa_aln_path</code> or <code>blast_path</code> arguments.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(orthologr)

<span class="co"># using the `aa_aln_path` or `blast_path` arguments</span>
<span class="kw">dNdS</span>( <span class="dt">query_file      =</span> <span class="kw">system.file</span>(<span class="st">'seqs/ortho_thal_cds.fasta'</span>, <span class="dt">package =</span> <span class="st">'orthologr'</span>),
      <span class="dt">subject_file    =</span> <span class="kw">system.file</span>(<span class="st">'seqs/ortho_lyra_cds.fasta'</span>, <span class="dt">package =</span> <span class="st">'orthologr'</span>),
      <span class="dt">ortho_detection =</span> <span class="st">&quot;RBH&quot;</span>,
      <span class="dt">blast_path      =</span> <span class="st">&quot;here/path/to/blastp&quot;</span>,
      <span class="dt">aa_aln_type     =</span> <span class="st">&quot;multiple&quot;</span>, 
      <span class="dt">aa_aln_tool     =</span> <span class="st">&quot;clustalw&quot;</span>, 
      <span class="dt">aa_aln_path     =</span> <span class="st">&quot;here/path/to/clustalw&quot;</span>,
      <span class="dt">codon_aln_tool  =</span> <span class="st">&quot;pal2nal&quot;</span>, 
      <span class="dt">dnds_est.method =</span> <span class="st">&quot;Comeron&quot;</span>, 
      <span class="dt">comp_cores      =</span> <span class="dv">1</span>, 
      <span class="dt">clean_folders   =</span> <span class="ot">TRUE</span>, 
      <span class="dt">quiet           =</span> <span class="ot">TRUE</span> )</code></pre></div>
<div id="advanced-options" class="section level2">
<h2>Advanced options</h2>
<p>Additional arguments can be passed to <code>dNdS()</code>. This allows you to use more advanced options of several interface programs.</p>
<p>To pass additional parameters to the interface programs, you can use the <code>blast_params</code> and <code>aa_aln_params</code> arguments. The <code>aa_aln_params</code> argument assumes that when you chose e.g. <code>aa_aln_tool = &quot;mafft&quot;</code> you will pass the corresponding additional parameters in MAFFT notation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(orthologr)

<span class="co"># get dNdS estimated for orthologous genes between A. thaliana and A. lyrata</span>
<span class="co"># using additional parameters:</span>

<span class="co"># get a dNdS table using:</span>
<span class="co"># 1) reciprocal best hit for orthology inference (RBH)</span>
<span class="co"># 2) multiple amino acid alignments using MAFFT</span>
<span class="co"># 3) pal2nal for codon alignments</span>
<span class="co"># 4) Comeron (1995) for dNdS estimation</span>
<span class="co"># 5) single core processing 'comp_cores = 1'</span>
Ath_Aly_dnds &lt;-<span class="st"> </span><span class="kw">dNdS</span>( <span class="dt">query_file      =</span> <span class="kw">system.file</span>(<span class="st">'seqs/ortho_thal_cds.fasta'</span>, <span class="dt">package =</span> <span class="st">'orthologr'</span>),
                      <span class="dt">subject_file    =</span> <span class="kw">system.file</span>(<span class="st">'seqs/ortho_lyra_cds.fasta'</span>, <span class="dt">package =</span> <span class="st">'orthologr'</span>),
                      <span class="dt">ortho_detection =</span> <span class="st">&quot;RBH&quot;</span>,
                      <span class="dt">blast_params    =</span> <span class="st">&quot;-matrix BLOSUM80&quot;</span>,
                      <span class="dt">aa_aln_tool     =</span> <span class="st">&quot;mafft&quot;</span>,
                      <span class="dt">aa_aln_params   =</span> <span class="st">&quot;--maxiterate 1 --clustalout&quot;</span>,
                      <span class="dt">dnds_est.method =</span> <span class="st">&quot;Comeron&quot;</span>,
                      <span class="dt">comp_cores      =</span> <span class="dv">1</span>, 
                      <span class="dt">clean_folders   =</span> <span class="ot">TRUE</span>, 
                      <span class="dt">quiet           =</span> <span class="ot">TRUE</span> )

        
<span class="co"># filter for:</span>
<span class="co"># 1) all dN values having an NA value are omitted</span>
<span class="co"># 2) all dS values having an NA value are omitted</span>
<span class="co"># 3) all dNdS values &gt;= 0.1 are omitted</span>

<span class="kw">filter_dNdS</span>(Ath_Aly_dnds, <span class="dt">dnds.threshold =</span> <span class="fl">0.1</span>)</code></pre></div>
<pre><code>
     query_id      subject_id       dN     dS    dNdS
1 AT1G01050.1 909874|PACid:16 0.000000 0.1750 0.00000
2 AT1G01090.1 470171|PACid:16 0.009843 0.2150 0.04579
3 AT1G01120.1 918858|PACid:16 0.003072 0.1326 0.02317
4 AT1G01140.3 470161|PACid:16 0.005672 0.1312 0.04324
5 AT1G01170.2 311317|PACid:16 0.008750 0.2827 0.03095
6 AT1G01220.1 470155|PACid:16 0.015210 0.1533 0.09919
</code></pre>
<p>Here <code>blast_params</code> and <code>aa_aln_params</code> take an character string specifying the parameters that shall be passed to BLAST and MAFFT. The notation of these parameters must follow the command line call of the stand alone versions of BLAST and MAFFT: e.g. <code>blast_params = &quot;blast_params = -matrix BLOSUM80&quot;</code> and <code>aa_aln_params = &quot;--maxiterate 1 --clustalout&quot;</code>.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
