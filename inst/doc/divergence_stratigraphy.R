## ---- echo = FALSE, message = FALSE-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
options(width = 750)
knitr::opts_chunk$set(
  comment = "#>",
  error = FALSE,
  tidy = FALSE)

## ----eval=FALSE-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#  system("blastp -version")

## ----eval=FALSE-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#  library(orthologr)
#  
#  # compute the divergence map of A. thaliana
#  Athaliana_DM <- divergence_stratigraphy(
#                           query_file      = "path/to/Arabidopsis_thaliana.TAIR10.23.cds.all.fa",
#                           subject_file    = "path/to/Arabidopsis_lyrata.v.1.0.23.cds.all.fa",
#                           eval            = "1E-5",
#                           ortho_detection = "RBH",
#                           comp_cores      = 1,
#                           quiet           = TRUE,
#                           clean_folders   = TRUE )
#  

## ----eval=FALSE-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#  library(orthologr)
#  
#  # performing standard divergence stratigraphy
#   divergence_stratigraphy(
#        query_file      = system.file('seqs/ortho_thal_cds.fasta', package = 'orthologr'),
#        subject_file    = system.file('seqs/ortho_lyra_cds.fasta', package = 'orthologr'),
#        eval            = "1E-5",
#        ortho_detection = "RBH",
#        dnds.threshold  = 2,
#        comp_cores      = 1,
#        quiet           = TRUE,
#        clean_folders   = TRUE)
#  

## ----eval=FALSE-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#  Athaliana_DM <- divergence_stratigraphy( ... )
#  
#  write.table(x         = Athaliana_DM,
#              file      = "Ath_Aly_DivergenceMap.csv",
#              sep       = ";",
#              col.names = TRUE,
#              row.names = FALSE,
#              quote     = FALSE)

## ----eval=FALSE-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#  library(orthologr)
#  
#  # performing standard divergence stratigraphy
#   divergence_stratigraphy(
#        query_file      = system.file('seqs/ortho_thal_cds.fasta', package = 'orthologr'),
#        subject_file    = system.file('seqs/ortho_lyra_cds.fasta', package = 'orthologr'),
#        blast_path      = "here/the/path/to/blastp",
#        eval            = "1E-5",
#        ortho_detection = "RBH",
#        dnds.threshold  = 2,
#        comp_cores      = 1,
#        quiet           = TRUE,
#        clean_folders   = TRUE)
#  

## ----eval=FALSE-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#  library(orthologr)
#  
#  # performing standard divergence stratigraphy
#  # but receive a dNdS Map instead of a Divergence Map
#   divergence_stratigraphy(
#        query_file      = system.file('seqs/ortho_thal_cds.fasta', package = 'orthologr'),
#        subject_file    = system.file('seqs/ortho_lyra_cds.fasta', package = 'orthologr'),
#        eval            = "1E-5",
#        ortho_detection = "RBH",
#        ds.values       = FALSE,
#        dnds.threshold  = 2,
#        comp_cores      = 1,
#        quiet           = TRUE,
#        clean_folders   = TRUE)
#  

## ----eval=FALSE-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#  
#  # receive a Divergence Map with DS | query GeneID | orthologous subject GeneID
#  divergence_stratigraphy(
#        query_file      = system.file('seqs/ortho_thal_cds.fasta', package = 'orthologr'),
#        subject_file    = system.file('seqs/ortho_lyra_cds.fasta', package = 'orthologr'),
#        eval            = "1E-5",
#        ortho_detection = "RBH",
#        comp_cores      = 1,
#        quiet           = TRUE,
#        clean_folders   = TRUE,
#        subject.id      = TRUE)
#  

## ----eval=FALSE-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#  
#  # receive a dNdS Map with dNdS | query GeneID | orthologous subject GeneID
#  divergence_stratigraphy(
#        query_file      = system.file('seqs/ortho_thal_cds.fasta', package = 'orthologr'),
#        subject_file    = system.file('seqs/ortho_lyra_cds.fasta', package = 'orthologr'),
#        eval            = "1E-5",
#        ortho_detection = "RBH",
#        comp_cores      = 1,
#        ds.values       = FALSE,
#        quiet           = TRUE,
#        clean_folders   = TRUE,
#        subject.id      = TRUE)
#  

## ----eval=FALSE-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#  # upper threshold for dNdS: dnds.threshold = 5
#   divergence_stratigraphy(
#        query_file      = system.file('seqs/ortho_thal_cds.fasta', package = 'orthologr'),
#        subject_file    = system.file('seqs/ortho_lyra_cds.fasta', package = 'orthologr'),
#        eval            = "1E-5",
#        ortho_detection = "RBH",
#        ds.values       = FALSE,
#        dnds.threshold  = 5,
#        comp_cores      = 1,
#        quiet           = TRUE,
#        clean_folders   = TRUE)
#  

## ----eval=FALSE-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#  # orthology inference method: ortho_detection = "BH"
#   divergence_stratigraphy(
#        query_file      = system.file('seqs/ortho_thal_cds.fasta', package = 'orthologr'),
#        subject_file    = system.file('seqs/ortho_lyra_cds.fasta', package = 'orthologr'),
#        eval            = "1E-5",
#        ortho_detection = "BH",
#        ds.values       = TRUE,
#        dnds.threshold  = 2,
#        comp_cores      = 1,
#        quiet           = TRUE,
#        clean_folders   = TRUE)
#  

